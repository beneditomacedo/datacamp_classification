---
title: 'Datacamp - Supervised Learning in R: Classification'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(eval = TRUE)
```

## Chapter 1: k-Nearest Neighbors (kNN)


Prepare the signs datasets 

```{r cars}
# loading training, test and example records
raw_signs <- read.csv("../data/knn_traffic_signs.csv")
# select only train rows
signs <- raw_signs[raw_signs$sample == "train",]
# remove id and sample columns
signs <- signs[-c(1,2)]
# select only test rows
test_signs <- raw_signs[raw_signs$sample == "test",]
# remove id and sample columns
test_signs <- test_signs[-c(1,2)]
# select only example row
next_sign <- raw_signs[raw_signs$sample == "example",]
# remove id, sample, sign_type columns
next_sign <- next_sign[-c(1:3)]
```

# Recognizing a road sign with kNN

Load the 'class' package

```{r}
library(class)
```

Create a vector of sign labels to use with kNN by extracting the column sign_type from signs.

```{r}
# Create a vector of labels
sign_types <- signs$sign_type
```


Identify the next_sign using the knn() function.

  + Set the train argument equal to the signs data frame without the first column.
  
  + Set the test argument equal to the data frame next_sign.
  
  + Use the vector of labels you created as the cl argument.

```{r}
# Classify the next sign observed
knn(train = signs[-1], test = next_sign, cl = sign_types)
```

# Exploring the traffic sign dataset

Use the str() function to examine the signs dataset.

```{r}
# Examine the structure of the signs dataset
str(signs)
```

Use table() to count the number of observations of each sign type by passing it the column containing the labels.

```{r}
# Count the number of signs of each type
table(signs$sign_type)
```

Run the provided aggregate() command to see whether the average red level might vary by sign type.

```{r}
# Check r10's average red level by sign type
aggregate(r10 ~ sign_type, data = signs, mean)
```

# Classifying a collection of road signs

Classify the test_signs data using knn().

  + Set train equal to the observations in signs without labels.
  
  + Use test_signs for the test argument, again without labels.
  
  + For the cl argument, use the vector of labels provided for you.
  
```{r}
# Use kNN to identify the test road signs
sign_types <- signs$sign_type
signs_pred <- knn(train = signs[-1], test = test_signs[-1], cl = sign_types)
```  

Use table() to explore the classifier's performance at identifying the three sign types (the confusion matrix).

  + Create the vector signs_actual by extracting the labels from test_signs.
  
  + Pass the vector of predictions and the vector of actual signs to table() to cross tabulate them.
  
```{r}
# Create a confusion matrix of the predicted versus actual values
signs_actual <- test_signs$sign_type
table(signs_pred, signs_actual)
```   

Compute the overall accuracy of the kNN learner using the mean() function.

```{r}
# Compute the accuracy
mean(signs_actual == signs_pred)
```  